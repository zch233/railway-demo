import{r as w,u as A}from"./ef14c475.js";import{Q as _,h as k,d as t,j as p,b3 as F,b0 as S,l as u}from"./2f07c074.js";import{u as C,_ as c}from"./1007c9c8.js";import{I as E}from"./d206b931.js";const R=_({name:"ModalImportTemp",emits:["updateDataSourceTemp","success"],expose:["showModal"],setup(j,d){const D=C(),e=k({visible:!1,loading:!1,formData:{file:[],clear:"0",date:[]}}),h=()=>{var a,o;if(!((a=e.formData.file)!=null&&a.length))throw u.error("\u8BF7\u4E0A\u4F20\u6587\u4EF6"),"\u6821\u9A8C\u9519\u8BEF";if(!((o=e.formData.date)!=null&&o.length))throw u.error("\u8BF7\u9009\u62E9\u751F\u6548\u65E5\u671F"),"\u6821\u9A8C\u9519\u8BEF"},b=()=>{h();const a=e.formData.file[0],o=new FileReader;o.onload=g=>{const v=new Uint8Array(g.target.result),m=w(v,{cellDates:!0}),M=A.sheet_to_json(m.Sheets[m.SheetNames[0]],{header:1,range:1}),y=Date.now(),f=M.slice(1).filter(l=>l.length).map(l=>{const r=l.reduce((n,s,i)=>(i===0?n[i]=y+"-"+s:n[i]=typeof s=="object"?S(s).format("HH:mm"):s,n),{});return r.status="1",r.dateRange=e.formData.date,r});d.emit("updateDataSourceTemp",{list:f,total:f.length}),d.emit("success"),e.visible=!1,u.success("\u5BFC\u5165\u6210\u529F")},o.readAsArrayBuffer(a),e.formData.clear==="1"&&D.setOrderList([])};return{Modal:()=>t(F,{visible:e.visible,"onUpdate:value":a=>e.visible=a,onOk:b,onCancel:()=>e.visible=!1,confirmLoading:e.loading,title:"\u4E34\u5BA2\u5BFC\u5165"},{default:()=>[t(c,{labelCol:{span:0},formData:e.formData,item:{key:"file",type:"upload.dragger",props:{customRequest:a=>e.formData.file=[a.file],uploadContent:()=>t("div",null,[t("p",{class:"ant-upload-drag-icon"},[t(E,null,null)]),t("p",{class:"ant-upload-text"},[p("\u5355\u51FB\u6216\u5C06\u6587\u4EF6\u62D6\u52A8\u5230\u6B64\u533A\u57DF\u4EE5\u4E0A\u4F20")]),t("p",{class:"ant-upload-hint"},[p("\u6587\u4EF6\u63D0\u793A")])]),name:"file"}}},null),t(c,{labelCol:{span:0},formData:e.formData,"onUpdate:formData":a=>e.formData.date=a.date,item:{key:"date",label:"\u751F\u6548\u65E5\u671F",type:"datePicker.rangePicker",props:{valueFormat:"YYYY-MM-DD"}}},null)]}),showModal:()=>e.visible=!0}},render(){return this.Modal()}});export{R as _};
